<UserControl x:Class="PiotrTrzpil.VisualMutator_VSPackage.Views.UnitTestsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ViewModels="clr-namespace:PiotrTrzpil.VisualMutator_VSPackage.ViewModels"
             xmlns:AttachedBehaviors="clr-namespace:PiotrTrzpil.VisualMutator_VSPackage.Views.AttachedBehaviors"
             xmlns:Converters="clr-namespace:PiotrTrzpil.VisualMutator_VSPackage.Views.Converters"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity" mc:Ignorable="d"
             d:DesignHeight="322" d:DesignWidth="624">

  <UserControl.Resources>

    <Converters:TestStatusToFillConverter x:Key="TestStatusToFillConverter"/>

    <Style TargetType="Rectangle" x:Key="TestStatusRectangleStyle">
      <Setter Property="Height" Value="10"/>
      <Setter Property="Width" Value="10"/>
        <Setter Property="Margin" Value="0,0,5,0"/>
      <Setter Property="Stroke" Value="Black"/>
    </Style>

  </UserControl.Resources>

  <Grid d:DataContext="{d:DesignInstance ViewModels:UnitTestsViewModel}">

    <Grid.RowDefinitions>
      <RowDefinition Height="25"/>
      <RowDefinition/>
      <RowDefinition Height="4"/>
      <RowDefinition/>
      <RowDefinition Height="4"/>
      <RowDefinition/>
    </Grid.RowDefinitions>

    <DockPanel Grid.Row="0">
      <Button HorizontalAlignment="Left" Content="Run Tests" Command="{Binding CommandRunTests}"/>
      <CheckBox Content="Current Solution" IsChecked="{Binding TestCurrentSolution}"/>

    </DockPanel>

    <ScrollViewer VerticalScrollBarVisibility="Auto" Grid.Row="1">
      <ListView AllowDrop="True" SelectionMode="Extended" ItemsSource="{Binding Mutants}"
                IsManipulationEnabled="True" SelectedItem="{Binding SelectedMutant}">

        <ListView.View>
          <GridView>
            <GridViewColumn Width="400" Header="Name" DisplayMemberBinding="{Binding Path=Name}"/>
            <GridViewColumn Width="300" Header="Datte" DisplayMemberBinding="{Binding Date}"/>
          </GridView>
        </ListView.View>
      </ListView>
    </ScrollViewer>
    <GridSplitter Grid.Row="2" Width="Auto" HorizontalAlignment="Stretch"/>

    <TreeView Grid.Row="3" ItemsSource="{Binding TestNamespaces}">
      <TreeView.ItemTemplate>
        <HierarchicalDataTemplate ItemsSource="{Binding TestClasses}">
          <DockPanel>
            <Rectangle Style="{StaticResource TestStatusRectangleStyle}"
                       Fill="{Binding Status, Converter={StaticResource TestStatusToFillConverter}}"/>
            <TextBlock Text="{Binding Name}"/>
          </DockPanel>

          <HierarchicalDataTemplate.ItemTemplate>
            <HierarchicalDataTemplate ItemsSource="{Binding TestMethods}">
              <DockPanel>
                <Rectangle Style="{StaticResource TestStatusRectangleStyle}"
                           Fill="{Binding Status, Converter={StaticResource TestStatusToFillConverter}}"/>
                <TextBlock Text="{Binding Name}"/>
              </DockPanel>

              <HierarchicalDataTemplate.ItemTemplate>
                <DataTemplate>
                  <DockPanel>
                    <Rectangle Style="{StaticResource TestStatusRectangleStyle}"
                               Fill="{Binding Status, Converter={StaticResource TestStatusToFillConverter}}"/>
                    <TextBlock Text="{Binding Name}"/>
                  </DockPanel>

                </DataTemplate>
              </HierarchicalDataTemplate.ItemTemplate>
            </HierarchicalDataTemplate>
          </HierarchicalDataTemplate.ItemTemplate>
        </HierarchicalDataTemplate>
      </TreeView.ItemTemplate>
      <TreeView.ItemContainerStyle>
        <Style TargetType="{x:Type TreeViewItem}">
          <Setter Property="AttachedBehaviors:MouseDoubleClickBehavior.MouseDoubleClick"
                  Value="{Binding CommandRunTest}"/>
          <Setter Property="TreeViewItem.IsExpanded" Value="True"/>
        </Style>

      </TreeView.ItemContainerStyle>
            <i:Interaction.Behaviors>
                <AttachedBehaviors:BindableSelectedItemBehaviour SelectedItem="{Binding SelectedTestItem, Mode=TwoWay}" />
            </i:Interaction.Behaviors>

        </TreeView>

    <GridSplitter Grid.Row="4" Width="Auto" HorizontalAlignment="Stretch"/>

    <ScrollViewer Grid.Row="5">
            <TextBlock Text="{Binding ResultText}"  />
        </ScrollViewer>

  </Grid>
</UserControl>